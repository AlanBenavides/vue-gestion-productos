(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56345a98"],{"0906":function(e,t,o){"use strict";var r=o("3701"),a=o.n(r);a.a},"0fbe":function(e,t,o){"use strict";var r=o("0fd5"),a=o.n(r);a.a},"0fd5":function(e,t,o){},"16f1":function(e,t,o){},"1cbc":function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"modal-produc"},[o("Short",{staticClass:"modal-pcontent",attrs:{allowMultipleSelect:!0,showOnlyProductsWithUnits:!0}})],1)},a=[],i=o("3a26"),n={name:"ModalProduct",components:{Short:i["a"]}},c=n,s=(o("f897"),o("2877")),d=Object(s["a"])(c,r,a,!1,null,"1d208cb5",null);t["a"]=d.exports},"363f":function(e,t,o){},3701:function(e,t,o){},"3a69":function(e,t,o){},"6d79":function(e,t,o){"use strict";var r=o("363f"),a=o.n(r);a.a},7821:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h1",{staticClass:"edit-prom-title"},[e._v("Editar Promoción")]),o("h2",{staticClass:"left"},[e._v("Paquete de productos:")]),o("ProductList"),e.isMoreThanTwo?o("div",{staticClass:"formulario_check-error-center"},[e._v(" Seleccione 2 productos como mínimo ")]):e._e(),o("div",[o("ImageAdd",{staticClass:"inline-elem",on:{"send-image":function(t){return e.passImage(t)}}}),o("Form",{staticClass:"inline-elem",attrs:{image:e.imagen}})],1)],1)},a=[],i=(o("b64b"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"formulario"},[o("form",{staticClass:"formulario_form",attrs:{autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Nombre de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.promocion.nombre_prom,expression:"promocion.nombre_prom"}],class:e.$v.promocion.nombre_prom.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text",required:""},domProps:{value:e.promocion.nombre_prom},on:{input:function(t){t.target.composing||e.$set(e.promocion,"nombre_prom",t.target.value)}}})]),e.$v.promocion.nombre_prom.alpha?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" No se aceptan caracteres especiales. ")]),e.$v.promocion.nombre_prom.minLength?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Debe tener una longitud no menor a "+e._s(e.$v.promocion.nombre_prom.$params.minLength.min)+". ")]),e.$v.promocion.nombre_prom.required?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promocion.nombre_prom.maxLength?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Nombre muy largo maximo "+e._s(e.$v.promocion.nombre_prom.$params.maxLength.max)+" caracteres. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Descripción:")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.promocion.descripcion,expression:"promocion.descripcion"}],class:e.$v.promocion.descripcion.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{cols:"50",rows:"10",maxlength:"1000"},domProps:{value:e.promocion.descripcion},on:{input:function(t){t.target.composing||e.$set(e.promocion,"descripcion",t.target.value)}}})]),o("div",{staticClass:"formulario_check-count"},[e._v(" "+e._s(e.promocion.descripcion.length+"/1000")+" caracteres. ")]),e.$v.promocion.descripcion.maxLength?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Descripcion muy larga maximo "+e._s(e.$v.promocion.descripcion.$params.maxLength.max)+" caracteres. ")]),e.$v.promocion.descripcion.required?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Precio(Bs.):")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.promocion.precio_unid,expression:"promocion.precio_unid"}],class:e.$v.promocion.precio_unid.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text"},domProps:{value:e.promocion.precio_unid},on:{input:function(t){t.target.composing||e.$set(e.promocion,"precio_unid",t.target.value)}}})]),e.$v.promocion.precio_unid.required?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promocion.precio_unid.between?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Campo invalido (0.10-10000). ")]),e.$v.promocion.precio_unid.validate_decimales?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Maximo 2 decimales! ")]),e.$v.promocion.precio_unid.alpha2?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese un valor numérico. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Cantidad:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.promocion.cantidad,expression:"promocion.cantidad"}],class:e.$v.promocion.cantidad.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text"},domProps:{value:e.promocion.cantidad},on:{input:function(t){t.target.composing||e.$set(e.promocion,"cantidad",t.target.value)}}})]),e.$v.promocion.cantidad.required?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promocion.cantidad.between?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese valores enteros entre (1-1000). ")]),e.$v.promocion.cantidad.integer?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Solo se aceptan valores enteros. ")]),e.$v.promocion.cantidad.alpha2?e._e():o("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese un valor numérico ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Inicio de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.promocion.fecha_inicio,expression:"promocion.fecha_inicio"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:e.promocion.fecha_inicio},on:{input:function(t){t.target.composing||e.$set(e.promocion,"fecha_inicio",t.target.value)}}})]),e.$v.promocion.fecha_inicio.validate_date?e._e():o("div",{staticClass:"formulario_check-error-center"},[e._v(" Fecha fuera de límite ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[e._v("Fin de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.promocion.fecha_fin,expression:"promocion.fecha_fin"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:e.promocion.fecha_fin},on:{input:function(t){t.target.composing||e.$set(e.promocion,"fecha_fin",t.target.value)}}})]),e.$v.promocion.fecha_fin.validate_date?e._e():o("div",{staticClass:"formulario_check-error-center"},[e._v(" Fecha fuera de límite ")]),e.$v.promocion.fecha_fin.validate_end_date?e._e():o("div",{staticClass:"formulario_check-error-center"},[e._v(" La promoción termina antes de empezar ")])]),o("button",{staticClass:"formulario_button",class:e.isAllValid,attrs:{disabled:e.$v.promocion.$invalid||""==e.image}},[e._v(" Confirmar ")])]),o("Alert",{ref:"alert"})],1)}),n=[],c=(o("99af"),o("c975"),o("d3b7"),o("ac1f"),o("1276"),o("ddb0"),o("96cf"),o("1da1")),s=o("b5ae"),d=o("98ab"),u=s["helpers"].regex("alpha",/^[a-zA-Z0-9ñ\sáéíóúÁÉÍÓÚ.,:;'`"-]*$/),m=s["helpers"].regex("alpha1",/^[0-9,.\s]*$/),l=function(e){var t=new Date,o=(new Date).setFullYear(t.getFullYear()+3),r=new Date(Date.parse(e));return r.setDate(r.getDate()+1),t<=r&&r<o},p=function(e,t){if(!t.fecha_inicio||!e)return!0;var o=new Date(Date.parse(t.fecha_inicio)),r=new Date(Date.parse(e));return o.setDate(o.getDate()+1),r.setDate(r.getDate()+1),o<r},f=function(e){var t=String(e);if(t.indexOf(".")>0){var o=t.split("."),r=String(o[1]);return!s["helpers"].req(e)||!(r.length>2)}return!0},_=function(e){return Object.keys(e).length>1},v={name:"Form",props:["image"],components:{Alert:d["a"]},data:function(){return{disabled:!1,promocion:{nombre_prom:null,descripcion:"",precio_unid:null,cantidad:null,fecha_inicio:"",fecha_fin:"",product_list:this.$store.state.groupIDselected}}},validations:{promocion:{nombre_prom:{required:s["required"],minLength:Object(s["minLength"])(2),maxLength:Object(s["maxLength"])(30),alpha:u},descripcion:{required:s["required"],maxLength:Object(s["maxLength"])(1e3)},precio_unid:{required:s["required"],between:Object(s["between"])(.1,1e4),validate_decimales:f,alpha2:m},cantidad:{required:s["required"],between:Object(s["between"])(1,1e3),integer:s["integer"],alpha2:m},fecha_inicio:{validate_date:l},fecha_fin:{validate_date:l,validate_end_date:p},product_list:{min_products:_}}},methods:{submitForm:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,""!=e.image){t.next=3;break}throw new Error("warning","Registra la imagen de la promoción");case 3:t.t0=regeneratorRuntime.keys(e.$store.state.groupIDselected);case 4:if((t.t1=t.t0()).done){t.next=13;break}if(o=t.t1.value,!(e.promotion.cantidad*e.$store.state.groupIDselected[o][0]>e.$store.state.groupIDselected[o][1])){t.next=8;break}throw new Error("No existen suficientes productos para esta promoción.");case 8:return t.next=10,e.sendDataProm();case 10:e.alert("success","Nueva promoción creada exitosamente"),t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t2=t["catch"](0),e.alert("warning",t.t2);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))()},sendDataProm:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.put("promotions/".concat(e.$store.state.idSelected[0]),{nombr_prom:e.promocion.nombre_prom,descrip_prom:e.promocion.descripcion,precio_prom:e.promocion.precio_unid,cantidad_prom:e.promocion.cantidad,fecha_ini:e.promocion.fecha_inicio,fecha_fin:e.promocion.fecha_fin,products:e.$store.state.groupIDselected,imagen_prom:e.image});case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t["catch"](0),new Error("El nombre de la promoción esta repetido");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},parseDate:function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},alert:function(e,t){this.$refs.alert.showAlert(e,t)}},computed:{isAllValid:function(){return this.$v.promocion.$invalid||""==this.image?"button-disabled":""}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/promotions/".concat(e.$store.state.idSelected[0]));case 2:o=t.sent,r=o.data.datos,e.promocion.nombre_prom=r[0].nombr_prom,e.promocion.descripcion=r[0].descrip_prom,e.promocion.precio_unid=r[0].precio_prom,e.promocion.cantidad=r[0].cantidad_prom,e.promocion.fecha_inicio=e.parseDate(r[0].fecha_ini),e.promocion.fecha_fin=e.parseDate(r[0].fecha_fin);case 10:case"end":return t.stop()}}),t)})))()}},h=v,g=(o("a784"),o("2877")),b=Object(g["a"])(h,i,n,!1,null,null,null),w=b.exports,$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"product-list"},[e._l(this.products,(function(t,o){return r("div",{key:t.cod_prod,staticClass:"it-container"},[r("h6",[e._v("Producto "+e._s(o+1))]),r("div",{staticClass:"it-add"},[r("button",{staticClass:"del-button",on:{click:function(o){return e.deleteProduct(t.cod_prod)}}},[e._v(" X ")]),r("Item",{staticClass:"promotion-item",attrs:{id_product:t.cod_prod,nombre:t.nombre_prod,precio:t.precio_unid,descripcion:t.descripcion,fecha:t.fecha_adic}}),r("label",[e._v("Cantidad: ")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.cant_products[t.cod_prod][0],expression:"cant_products[product.cod_prod][0]",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:t.cantidad,onkeydown:"return false"},domProps:{value:e.cant_products[t.cod_prod][0]},on:{change:function(o){return e.upCounts(t.cod_prod)},input:function(o){o.target.composing||e.$set(e.cant_products[t.cod_prod],0,e._n(o.target.value))},blur:function(t){return e.$forceUpdate()}}})],1)])})),this.products.length<5?r("div",{staticClass:"it-container"},[r("h6",[e._v("Nuevo Producto")]),r("div",{staticClass:"it-add",on:{click:function(t){e.showModal=!e.showModal}}},[r("img",{staticClass:"im-add",attrs:{src:o("be71"),alt:"",width:"340"}})])]):e._e(),this.showModal?r("ModalProduct"):e._e(),this.showModal?r("button",{staticClass:"modl-button term",on:{click:function(t){return e.addProducts()}}},[e._v(" Añadir productos ")]):e._e(),this.showModal?r("button",{staticClass:"modl-button ext",on:{click:function(t){return e.updateProducts()}}},[e._v(" X ")]):e._e(),r("Alert",{ref:"alert"})],2)},C=[],x=o("b85c"),k=o("1cbc"),D=o("be89"),P={name:"ProductList",components:{ModalProduct:k["a"],Item:D["a"],Alert:d["a"]},data:function(){return{showModal:!1,products:[],cant_products:{}}},methods:{addProducts:function(){Object.keys(this.$store.state.groupIDselected).length>0?(this.getProducts(),this.showModal=!this.showModal,this.alert("success","Productos añadidos.")):this.alert("warning","No tienes productos seleccionados.")},getProducts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=[],r={},t.t0=regeneratorRuntime.keys(e.$store.state.groupIDselected);case 3:if((t.t1=t.t0()).done){t.next=12;break}return a=t.t1.value,t.next=7,e.$http.get("products/".concat(a));case 7:i=t.sent,o.push(i.data.datos[0]),r[a]=[e.$store.state.groupIDselected[a][0],i.data.datos[0].cantidad],t.next=3;break;case 12:e.products=o,e.cant_products=r;case 14:case"end":return t.stop()}}),t)})))()},deleteProduct:function(e){this.$store.commit("deleteID",e),this.getProducts()},updateProducts:function(){this.$store.commit("updateGroup",this.cant_products),this.showModal=!this.showModal},upCounts:function(e){this.$store.state.groupIDselected[e]=this.cant_products[e]},alert:function(e,t){this.$refs.alert.showAlert(e,t)}},updateProducts:function(){this.$store.commit("updateGroup",this.cant_products),this.showModal=!this.showModal},upCounts:function(e){this.$store.state.groupIDselected[e]=this.cant_products[e]},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o,r,a,i,n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/promotions/".concat(e.$store.state.idSelected[0]));case 2:o=t.sent,r=o.data.prod,a={},i=Object(x["a"])(r);try{for(i.s();!(n=i.n()).done;)c=n.value,a[c.cod_prod]=[c.cant_prod,c.cantidad]}catch(s){i.e(s)}finally{i.f()}e.$store.commit("updateGroup",a),e.getProducts();case 9:case"end":return t.stop()}}),t)})))()}},I=P,y=(o("0fbe"),Object(g["a"])(I,$,C,!1,null,"748e5596",null)),M=y.exports,j=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"image-container"},[o("p",[e._v("Foto de la promoción")]),o("div",{staticClass:"image-add"},[o("img",{staticClass:"img-prom",attrs:{src:e.imagen,height:"/img/plus-circle.2de4ac5c.svg"==e.imagen?120:""},on:{click:function(t){return e.addFiles()}}})]),o("input",{ref:"files",staticClass:"images_input",attrs:{type:"file",id:"files",accept:"image/*"},on:{change:function(t){return e.getImage()}}}),o("Alert",{ref:"alert"})],1)},O=[],A=(o("b0c0"),{name:"ImageAdd",components:{Alert:d["a"]},data:function(){return{image:""}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/promotions/image/".concat(e.$store.state.idSelected[0]));case 2:o=t.sent,e.image="data:image/[jpg/png];base64,"+o.data.datos[0].imagen_prom,e.$emit("send-image",o.data.datos[0].imagen_prom);case 5:case"end":return t.stop()}}),t)})))()},computed:{imagen:function(){return""==this.image?o("be71"):this.image}},methods:{addFiles:function(){this.$refs.files.click()},getImage:function(){var e=this,t=this.$refs.files.files,o=t[0];if(void 0!=o)if(/\.(jpe?g|png)$/i.test(o.name))if(o.size>1048576)this.alert("warning","".concat(o.name," es muy pesado (> 1MB)"));else{var r=new FileReader;r.addEventListener("load",(function(t){var r=new Image;r.onload=function(){r.width<640||r.width>1366?e.alert("warning","El ancho de ".concat(o.name," debe estar entre 640px y 1366px")):r.height<360||r.height>768?e.alert("warning","El alto de ".concat(o.name," debe estar entre 360px y 768px")):(e.image=t.target.result,e.$emit("send-image",e.image))},r.src=t.target.result})),r.readAsDataURL(o)}else this.alert("warning","".concat(o.name," no es un archivo jpg o png"))},alert:function(e,t){this.$refs.alert.showAlert(e,t)}}}),q=A,L=(o("0906"),Object(g["a"])(q,j,O,!1,null,null,null)),R=L.exports,F={name:"EdicionPromocion",components:{Form:w,ProductList:M,ImageAdd:R},data:function(){return{imagen:""}},methods:{passImage:function(e){this.imagen=e}},computed:{isMoreThanTwo:function(){return Object.keys(this.$store.state.groupIDselected).length<2}},destroyed:function(){this.$store.commit("updateGroup",{})}},E=F,N=(o("6d79"),Object(g["a"])(E,r,a,!1,null,"0bcda8a4",null));t["default"]=N.exports},a784:function(e,t,o){"use strict";var r=o("16f1"),a=o.n(r);a.a},be71:function(e,t,o){e.exports=o.p+"img/plus-circle.2de4ac5c.svg"},f897:function(e,t,o){"use strict";var r=o("3a69"),a=o.n(r);a.a}}]);
//# sourceMappingURL=chunk-56345a98.27ac66a8.js.map