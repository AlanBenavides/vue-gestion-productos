(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fc583b3e"],{"02f1":function(t,e,o){"use strict";var r=o("5e5f"),a=o.n(r);a.a},"1cbc":function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-produc"},[o("Short",{staticClass:"modal-pcontent",attrs:{allowMultipleSelect:!0,showOnlyProductsWithUnits:!0}})],1)},a=[],i=o("3a26"),n={name:"ModalProduct",components:{Short:i["a"]}},s=n,c=(o("f897"),o("2877")),u=Object(c["a"])(s,r,a,!1,null,"1d208cb5",null);e["a"]=u.exports},"37cf":function(t,e,o){},"3a69":function(t,e,o){},"3b02":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("h1",{staticClass:"formulario_title"},[t._v("Registro de Promoción")]),t._m(0),o("ProductList"),t.isMoreThanTwo?o("div",{staticClass:"formulario_check-error-center"},[t._v(" Seleccione 2 productos como mínimo ")]):t._e(),o("div",[o("ImageAdd",{staticClass:"inline-elem",on:{"send-image":function(e){return t.passImage(e)}}}),o("Form",{staticClass:"inline-elem",attrs:{image:t.imagen}})],1)],1)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("h2",{staticClass:"left"},[o("strong",[t._v("Paquete de productos:")])])}],i=(o("b64b"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"formulario"},[o("form",{staticClass:"formulario_form",attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.submitForm(e)}}},[o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Nombre de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.promotion.promName,expression:"promotion.promName"}],class:t.$v.promotion.promName.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text",required:""},domProps:{value:t.promotion.promName},on:{input:function(e){e.target.composing||t.$set(t.promotion,"promName",e.target.value)}}})]),t.$v.promotion.promName.alpha?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" No se aceptan caracteres especiales. ")]),t.$v.promotion.promName.minLength?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Debe tener una longitud no menor a "+t._s(t.$v.promotion.promName.$params.minLength.min)+". ")]),t.$v.promotion.promName.required?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Campo requerido. ")]),t.$v.promotion.promName.maxLength?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Nombre muy largo maximo "+t._s(t.$v.promotion.promName.$params.maxLength.max)+" caracteres. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Descripción:")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.promotion.description,expression:"promotion.description"}],class:t.$v.promotion.description.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{cols:"50",rows:"10",maxlength:"1000"},domProps:{value:t.promotion.description},on:{input:function(e){e.target.composing||t.$set(t.promotion,"description",e.target.value)}}})]),o("div",{staticClass:"formulario_check-count"},[t._v(" "+t._s(t.promotion.description.length+"/1000")+" caracteres. ")]),t.$v.promotion.description.maxLength?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Descripcion muy larga maximo "+t._s(t.$v.promotion.description.$params.maxLength.max)+" caracteres. ")]),t.$v.promotion.description.required?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Campo requerido. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Precio(Bs.):")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.promotion.unitPrice,expression:"promotion.unitPrice"}],class:t.$v.promotion.unitPrice.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text"},domProps:{value:t.promotion.unitPrice},on:{input:function(e){e.target.composing||t.$set(t.promotion,"unitPrice",e.target.value)}}})]),t.$v.promotion.unitPrice.required?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Campo requerido. ")]),t.$v.promotion.unitPrice.between?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Campo invalido (0.10-10000). ")]),t.$v.promotion.unitPrice.validateDecimals?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Maximo 2 decimales! ")]),t.$v.promotion.unitPrice.alpha2?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Ingrese un valor numérico. ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Cantidad:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.promotion.quantity,expression:"promotion.quantity"}],class:t.$v.promotion.quantity.$invalid?"formulario_check-input-error":"formulario_check-input",attrs:{type:"text"},domProps:{value:t.promotion.quantity},on:{input:function(e){e.target.composing||t.$set(t.promotion,"quantity",e.target.value)}}})]),t.$v.promotion.quantity.required?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Campo requerido. ")]),t.$v.promotion.quantity.between?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Ingrese valores enteros entre (1-1000). ")]),t.$v.promotion.quantity.integer?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Solo se aceptan valores enteros. ")]),t.$v.promotion.quantity.alpha2?t._e():o("div",{staticClass:"formulario_check-error"},[t._v(" Ingrese un valor numérico ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Inicio de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.promotion.startDate,expression:"promotion.startDate"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:t.promotion.startDate},on:{input:function(e){e.target.composing||t.$set(t.promotion,"startDate",e.target.value)}}})]),t.$v.promotion.startDate.validateDate?t._e():o("div",{staticClass:"formulario_check-error-center"},[t._v(" Fecha fuera de límite ")])]),o("div",{staticClass:"formulario_group"},[o("label",[o("div",{staticClass:"formulario_name"},[t._v("Fin de promoción:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.promotion.endDate,expression:"promotion.endDate"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:t.promotion.endDate},on:{input:function(e){e.target.composing||t.$set(t.promotion,"endDate",e.target.value)}}})]),t.$v.promotion.endDate.validateDate?t._e():o("div",{staticClass:"formulario_check-error-center"},[t._v(" Fecha fuera de límite ")]),t.$v.promotion.endDate.validateEndDate?t._e():o("div",{staticClass:"formulario_check-error-center"},[t._v(" La promoción termina antes de empezar ")])]),o("button",{staticClass:"formulario_button",class:t.isAllValid,attrs:{disabled:t.$v.promotion.$invalid||""==t.image}},[t._v(" Confirmar ")])]),o("Alert",{ref:"alert"})],1)}),n=[],s=(o("a4d3"),o("e01a"),o("c975"),o("d3b7"),o("ac1f"),o("1276"),o("ddb0"),o("96cf"),o("1da1")),c=o("b5ae"),u=o("98ab"),l=c["helpers"].regex("alpha",/^[a-zA-Z0-9ñ\sáéíóúÁÉÍÓÚ.,:;'`"-]*$/),d=c["helpers"].regex("alpha1",/^[0-9,.\s]*$/),m=function(t){var e=new Date,o=(new Date).setFullYear(e.getFullYear()+3),r=new Date(Date.parse(t));return r.setDate(r.getDate()+1),e<=r&&r<o},p=function(t,e){if(!e.startDate||!t)return!0;var o=new Date(Date.parse(e.startDate)),r=new Date(Date.parse(t));return o.setDate(o.getDate()+1),r.setDate(r.getDate()+1),o<r},v=function(t){if(String(t).indexOf(".")>0){var e=String(t).split("."),o=String(e[1]);return!c["helpers"].req(t)||!(o.length>2)}return!0},f=function(t){return Object.keys(t).length>1},h={name:"Form",props:["image"],components:{Alert:u["a"]},data:function(){return{disabled:!1,promotion:{promName:null,description:"",unitPrice:null,quantity:null,startDate:"",endDate:"",productList:this.$store.state.groupIDselected}}},validations:{promotion:{promName:{required:c["required"],minLength:Object(c["minLength"])(2),maxLength:Object(c["maxLength"])(30),alpha:l},description:{required:c["required"],maxLength:Object(c["maxLength"])(1e3)},unitPrice:{required:c["required"],between:Object(c["between"])(.1,1e4),validateDecimals:v,alpha2:d},quantity:{required:c["required"],between:Object(c["between"])(1,1e3),integer:c["integer"],alpha2:d},startDate:{validateDate:m},endDate:{validateDate:m,validateEndDate:p},productList:{validateMinProductsCount:f}}},methods:{submitForm:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,""!=t.image){e.next=3;break}throw new Error("warning","Registra la imagen de la promoción");case 3:e.t0=regeneratorRuntime.keys(t.$store.state.groupIDselected);case 4:if((e.t1=e.t0()).done){e.next=13;break}if(o=e.t1.value,!(t.promotion.quantity*t.$store.state.groupIDselected[o][0]>t.$store.state.groupIDselected[o][1])){e.next=8;break}throw new Error("No existen suficientes productos para esta promoción.");case 8:return e.next=10,t.sendDataProm();case 10:t.alert("success","Nueva promoción creada exitosamente"),e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t2=e["catch"](0),t.alert("warning",e.t2);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))()},sendDataProm:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.post("promotions",{nombr_prom:t.promotion.promName,descrip_prom:t.promotion.description,precio_prom:t.promotion.unitPrice,cantidad_prom:t.promotion.quantity,fecha_ini:t.promotion.startDate,fecha_fin:t.promotion.endDate,products:t.$store.state.groupIDselected,imagen_prom:t.image});case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e["catch"](0),new Error("El nombre de la promoción esta repetido");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},alert:function(t,e){this.$refs.alert.showAlert(t,e)}},computed:{isAllValid:function(){return this.$v.promotion.$invalid||""==this.image?"button-disabled":""}}},g=h,_=(o("8103"),o("2877")),b=Object(_["a"])(g,i,n,!1,null,null,null),$=b.exports,C=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"product-list"},[t._l(this.products,(function(e,o){return r("div",{key:e.cod_prod,staticClass:"it-container"},[r("h6",[t._v("Producto "+t._s(o+1))]),r("div",{staticClass:"it-add"},[r("button",{staticClass:"del-button",on:{click:function(o){return t.deleteProduct(e.cod_prod)}}},[t._v(" X ")]),r("Item",{attrs:{id_product:e.cod_prod,nombre:e.nombre_prod,precio:e.precio_unid,descripcion:e.descripcion,fecha:e.fecha_adic}}),r("label",[t._v("Cantidad: ")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.productsCount[e.cod_prod][0],expression:"productsCount[product.cod_prod][0]",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:e.cantidad,onkeydown:"return false"},domProps:{value:t.productsCount[e.cod_prod][0]},on:{change:function(o){return t.upCounts(e.cod_prod)},input:function(o){o.target.composing||t.$set(t.productsCount[e.cod_prod],0,t._n(o.target.value))},blur:function(e){return t.$forceUpdate()}}})],1)])})),this.products.length<5?r("div",{staticClass:"it-container"},[r("h6",[t._v("Nuevo Producto")]),r("div",{staticClass:"it-add",on:{click:function(e){t.showModal=!t.showModal}}},[r("img",{staticClass:"im-add",attrs:{src:o("be71"),alt:"",width:"340"}})])]):t._e(),this.showModal?r("ModalProduct"):t._e(),this.showModal?r("button",{staticClass:"modl-button term",on:{click:function(e){return t.addProducts()}}},[t._v(" Añadir productos ")]):t._e(),this.showModal?r("button",{staticClass:"modl-button ext",on:{click:function(e){return t.updateProducts()}}},[t._v(" X ")]):t._e(),r("Alert",{ref:"alert"})],2)},w=[],D=o("1cbc"),k=o("be89"),x={name:"ProductList",components:{ModalProduct:D["a"],Item:k["a"],Alert:u["a"]},data:function(){return{showModal:!1,products:[],productsCount:{}}},mounted:function(){-1!=this.$store.state.idSelected[0]&&this.$store.commit("addID",this.$store.state.idSelected),this.getProducts()},methods:{addProducts:function(){Object.keys(this.$store.state.groupIDselected).length>0?(this.getProducts(),this.showModal=!this.showModal,this.alert("success","Productos añadidos.")):this.alert("warning","No tienes productos seleccionados.")},getProducts:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var o,r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=[],r={},e.t0=regeneratorRuntime.keys(t.$store.state.groupIDselected);case 3:if((e.t1=e.t0()).done){e.next=12;break}return a=e.t1.value,e.next=7,t.$http.get("products/".concat(a));case 7:i=e.sent,o.push(i.data.datos[0]),r[a]=[t.$store.state.groupIDselected[a][0],i.data.datos[0].cantidad],e.next=3;break;case 12:t.products=o,t.productsCount=r;case 14:case"end":return e.stop()}}),e)})))()},deleteProduct:function(t){this.$store.commit("deleteID",t),this.getProducts()},updateProducts:function(){this.$store.commit("updateGroup",this.productsCount),this.showModal=!this.showModal},upCounts:function(t){this.$store.state.groupIDselected[t]=this.productsCount[t]},alert:function(t,e){this.$refs.alert.showAlert(t,e)}},deleteProduct:function(t){this.$store.commit("deleteID",t),this.getProducts()},updateProducts:function(){this.$store.commit("updateGroup",this.productsCount),this.showModal=!this.showModal},upCounts:function(t){this.$store.state.groupIDselected[t]=this.productsCount[t]}},P=x,y=(o("02f1"),Object(_["a"])(P,C,w,!1,null,"34d7d851",null)),q=y.exports,I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"image-container"},[o("p",[t._v("Foto de la promoción")]),o("div",{staticClass:"image-add"},[o("img",{staticClass:"img-prom",attrs:{src:t.imagen,height:"/img/plus-circle.2de4ac5c.svg"==t.imagen?120:""},on:{click:function(e){return t.addFiles()}}})]),o("input",{ref:"files",staticClass:"images_input",attrs:{type:"file",id:"files",accept:"image/*"},on:{change:function(e){return t.getImage()}}}),o("Alert",{ref:"alert"})],1)},N=[],M=(o("b0c0"),{name:"ImageAdd",components:{Alert:u["a"]},data:function(){return{image:""}},computed:{imagen:function(){return""==this.image?o("be71"):this.image}},methods:{addFiles:function(){this.$refs.files.click()},getImage:function(){var t=this,e=this.$refs.files.files,o=e[0];if(void 0!=o)if(/\.(jpe?g|png)$/i.test(o.name))if(o.size>1048576)this.alert("warning","".concat(o.name," es muy pesado (> 1MB)"));else{var r=new FileReader;r.addEventListener("load",(function(e){var r=new Image;r.onload=function(){r.width<640||r.width>1366?t.alert("warning","El ancho de ".concat(o.name," debe estar entre 640px y 1366px")):r.height<360||r.height>768?t.alert("warning","El alto de ".concat(o.name," debe estar entre 360px y 768px")):(t.image=e.target.result,t.$emit("send-image",t.image))},r.src=e.target.result})),r.readAsDataURL(o)}else this.alert("warning","".concat(o.name," no es un archivo jpg o png"))},alert:function(t,e){this.$refs.alert.showAlert(t,e)}}}),A=M,L=(o("91d8"),Object(_["a"])(A,I,N,!1,null,null,null)),j=L.exports,O={name:"RegistroPromocion",components:{Form:$,ProductList:q,ImageAdd:j},data:function(){return{imagen:""}},methods:{passImage:function(t){this.imagen=t}},computed:{isMoreThanTwo:function(){return Object.keys(this.$store.state.groupIDselected).length<2}},destroyed:function(){this.$store.commit("updateGroup",{})}},E=O,F=(o("404e"),Object(_["a"])(E,r,a,!1,null,"9943a6b2",null));e["default"]=F.exports},"404e":function(t,e,o){"use strict";var r=o("b0a1"),a=o.n(r);a.a},"5e5f":function(t,e,o){},8103:function(t,e,o){"use strict";var r=o("b651"),a=o.n(r);a.a},"91d8":function(t,e,o){"use strict";var r=o("37cf"),a=o.n(r);a.a},b0a1:function(t,e,o){},b651:function(t,e,o){},be71:function(t,e,o){t.exports=o.p+"img/plus-circle.2de4ac5c.svg"},f897:function(t,e,o){"use strict";var r=o("3a69"),a=o.n(r);a.a}}]);
//# sourceMappingURL=chunk-fc583b3e.682b45ac.js.map