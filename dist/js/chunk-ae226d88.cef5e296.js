(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae226d88"],{"1cbc":function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal-produc"},[r("Short",{staticClass:"modal-pcontent",attrs:{allowMultipleSelect:!0,showOnlyProductsWithUnits:!0}})],1)},a=[],i=r("3a26"),n={name:"ModalProduct",components:{Short:i["a"]}},s=n,c=(r("faab"),r("2877")),u=Object(c["a"])(s,o,a,!1,null,"e55b4e28",null);t["a"]=u.exports},"37cf":function(e,t,r){},"3b02":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._m(0),e._m(1),r("ProductList"),e.isMoreThanTwo?r("div",{staticClass:"formulario_check-error-center"},[e._v(" Seleccione 2 productos como mínimo ")]):e._e(),r("div",[r("ImageAdd",{staticClass:"inline-elem",on:{"send-image":function(t){return e.passImage(t)}}}),r("Form",{staticClass:"inline-elem",attrs:{image:e.imagen}})],1)],1)},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",[r("strong",[e._v("Registro de Promoción")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h3",{staticClass:"left"},[r("strong",[e._v("Paquete de productos:")])])}],i=(r("b64b"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"formulario"},[r("form",{staticClass:"formulario_form",attrs:{autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.submitForm(t)}}},[r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Nombre de promoción:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.promotion.promName,expression:"promotion.promName"}],style:e.$v.promotion.promName.$invalid?"border:1px solid red ":"border:1px solid green ",attrs:{type:"text",required:""},domProps:{value:e.promotion.promName},on:{input:function(t){t.target.composing||e.$set(e.promotion,"promName",t.target.value)}}})]),e.$v.promotion.promName.alpha?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" No se aceptan caracteres especiales. ")]),e.$v.promotion.promName.minLength?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Debe tener una longitud no menor a "+e._s(e.$v.promotion.promName.$params.minLength.min)+". ")]),e.$v.promotion.promName.required?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promotion.promName.maxLength?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Nombre muy largo maximo "+e._s(e.$v.promotion.promName.$params.maxLength.max)+" caracteres. ")])]),r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Descripción:")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.promotion.description,expression:"promotion.description"}],style:e.$v.promotion.description.$invalid?"border:1px solid red ":"border:1px solid green ",attrs:{cols:"50",rows:"10",maxlength:"1000"},domProps:{value:e.promotion.description},on:{input:function(t){t.target.composing||e.$set(e.promotion,"description",t.target.value)}}})]),r("div",{staticClass:"formulario_check-error1"},[e._v(" "+e._s(e.promotion.description.length+"/1000")+" caracteres. ")]),e.$v.promotion.description.maxLength?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Descripcion muy larga maximo "+e._s(e.$v.promotion.description.$params.maxLength.max)+" caracteres. ")]),e.$v.promotion.description.required?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")])]),r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Precio(Bs.):")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.promotion.unitPrice,expression:"promotion.unitPrice"}],style:e.$v.promotion.unitPrice.$invalid?"border:1px solid red ":"border:1px solid green ",attrs:{type:"text"},domProps:{value:e.promotion.unitPrice},on:{input:function(t){t.target.composing||e.$set(e.promotion,"unitPrice",t.target.value)}}})]),e.$v.promotion.unitPrice.required?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promotion.unitPrice.between?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Campo invalido (0.10-10000). ")]),e.$v.promotion.unitPrice.validateDecimals?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Maximo 2 decimales! ")]),e.$v.promotion.unitPrice.alpha2?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese un valor numérico. ")])]),r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Cantidad:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.promotion.quantity,expression:"promotion.quantity"}],style:e.$v.promotion.quantity.$invalid?"border:1px solid red ":"border:1px solid green ",attrs:{type:"text"},domProps:{value:e.promotion.quantity},on:{input:function(t){t.target.composing||e.$set(e.promotion,"quantity",t.target.value)}}})]),e.$v.promotion.quantity.required?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Campo requerido. ")]),e.$v.promotion.quantity.between?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese valores enteros entre (1-1000). ")]),e.$v.promotion.quantity.integer?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Solo se aceptan valores enteros. ")]),e.$v.promotion.quantity.alpha2?e._e():r("div",{staticClass:"formulario_check-error"},[e._v(" Ingrese un valor numérico ")])]),r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Inicio de promoción:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.promotion.startDate,expression:"promotion.startDate"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:e.promotion.startDate},on:{input:function(t){t.target.composing||e.$set(e.promotion,"startDate",t.target.value)}}})]),e.$v.promotion.startDate.validateDate?e._e():r("div",{staticClass:"formulario_check-error-center"},[e._v(" Fecha fuera de límite ")])]),r("div",{staticClass:"formulario_group"},[r("label",[r("div",{staticClass:"formulario_name"},[e._v("Fin de promoción:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.promotion.endDate,expression:"promotion.endDate"}],attrs:{type:"date",value:"DD/MM/AA",onkeydown:"return false"},domProps:{value:e.promotion.endDate},on:{input:function(t){t.target.composing||e.$set(e.promotion,"endDate",t.target.value)}}})]),e.$v.promotion.endDate.validateDate?e._e():r("div",{staticClass:"formulario_check-error-center"},[e._v(" Fecha fuera de límite ")]),e.$v.promotion.endDate.validateEndDate?e._e():r("div",{staticClass:"formulario_check-error-center"},[e._v(" La promoción termina antes de empezar ")])]),r("button",{staticClass:"formulario_button",class:e.isAllValid,attrs:{disabled:e.$v.promotion.$invalid||""==e.image}},[e._v(" Confirmar ")])])])}),n=[],s=(r("a4d3"),r("e01a"),r("c975"),r("d3b7"),r("ac1f"),r("1276"),r("ddb0"),r("96cf"),r("1da1")),c=r("b5ae"),u=c["helpers"].regex("alpha",/^[a-zA-Z0-9ñ\sáéíóúÁÉÍÓÚ.,:;'`"-]*$/),d=c["helpers"].regex("alpha1",/^[0-9,.\s]*$/),l=function(e){var t=new Date,r=(new Date).setFullYear(t.getFullYear()+3),o=new Date(Date.parse(e));return o.setDate(o.getDate()+1),t<=o&&o<r},m=function(e,t){if(!t.startDate||!e)return!0;var r=new Date(Date.parse(t.startDate)),o=new Date(Date.parse(e));return r.setDate(r.getDate()+1),o.setDate(o.getDate()+1),r<o},p=function(e){if(String(e).indexOf(".")>0){var t=String(e).split("."),r=String(t[1]);return!c["helpers"].req(e)||!(r.length>2)}return!0},v=function(e){return Object.keys(e).length>1},f={name:"Form",props:["image"],data:function(){return{disabled:!1,promotion:{promName:null,description:"",unitPrice:null,quantity:null,startDate:"",endDate:"",productList:this.$store.state.groupIDselected}}},validations:{promotion:{promName:{required:c["required"],minLength:Object(c["minLength"])(2),maxLength:Object(c["maxLength"])(30),alpha:u},description:{required:c["required"],maxLength:Object(c["maxLength"])(1e3)},unitPrice:{required:c["required"],between:Object(c["between"])(.1,1e4),validateDecimals:p,alpha2:d},quantity:{required:c["required"],between:Object(c["between"])(1,1e3),integer:c["integer"],alpha2:d},startDate:{validateDate:l},endDate:{validateDate:l,validateEndDate:m},productList:{validateMinProductsCount:v}}},methods:{submitForm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.$v.promotion.$invalid){t.next=19;break}if(""!=e.image){t.next=6;break}alert("Registra la imagen de la promoción"),t.next=17;break;case 6:t.t0=regeneratorRuntime.keys(e.$store.state.groupIDselected);case 7:if((t.t1=t.t0()).done){t.next=14;break}if(r=t.t1.value,!(e.promotion.quantity*e.$store.state.groupIDselected[r][0]>e.$store.state.groupIDselected[r][1])){t.next=12;break}return alert("No existen suficientes productos para esta promoción."),t.abrupt("return");case 12:t.next=7;break;case 14:return t.next=16,e.sendDataProm();case 16:alert("Nueva promoción creada exitosamente");case 17:t.next=20;break;case 19:alert("Rellene todos los datos correctamente");case 20:t.next=25;break;case 22:t.prev=22,t.t2=t["catch"](0),alert(t.t2);case 25:case"end":return t.stop()}}),t,null,[[0,22]])})))()},sendDataProm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("promotions",{nombr_prom:e.promotion.promName,descrip_prom:e.promotion.description,precio_prom:e.promotion.unitPrice,cantidad_prom:e.promotion.quantity,fecha_ini:e.promotion.startDate,fecha_fin:e.promotion.endDate,products:e.$store.state.groupIDselected,imagen_prom:e.image});case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t["catch"](0),new Error("El nombre de la promoción esta repetido");case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()}},computed:{isAllValid:function(){return this.$v.promotion.$invalid||""==this.image?"form_button_disabled":""}}},g=f,h=(r("8103"),r("2877")),_=Object(h["a"])(g,i,n,!1,null,null,null),b=_.exports,$=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"product-list"},[e._l(this.products,(function(t,r){return o("div",{key:t.cod_prod,staticClass:"it-container"},[o("h6",[e._v("Producto "+e._s(r+1))]),o("div",{staticClass:"it-add"},[o("button",{staticClass:"del-button",on:{click:function(r){return e.deleteProduct(t.cod_prod)}}},[e._v("X")]),o("Item",{attrs:{id_product:t.cod_prod,nombre:t.nombre_prod,precio:t.precio_unid,descripcion:t.descripcion,fecha:t.fecha_adic}}),o("label",[e._v("Cantidad: ")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.productsCount[t.cod_prod][0],expression:"productsCount[product.cod_prod][0]",modifiers:{number:!0}}],attrs:{type:"number",min:"1",max:t.cantidad},domProps:{value:e.productsCount[t.cod_prod][0]},on:{change:function(r){return e.upCounts(t.cod_prod)},input:function(r){r.target.composing||e.$set(e.productsCount[t.cod_prod],0,e._n(r.target.value))},blur:function(t){return e.$forceUpdate()}}})],1)])})),this.products.length<5?o("div",{staticClass:"it-container"},[o("h6",[e._v("Nuevo Producto")]),o("div",{staticClass:"it-add",on:{click:function(t){e.showModal=!e.showModal}}},[o("img",{staticClass:"im-add",attrs:{src:r("a861"),alt:"",width:"340"}})])]):e._e(),this.showModal?o("ModalProduct"):e._e(),this.showModal?o("button",{staticClass:"modl-button term",on:{click:function(t){return e.addProducts()}}},[e._v("Añadir productos")]):e._e(),this.showModal?o("button",{staticClass:"modl-button ext",on:{click:function(t){return e.updateProducts()}}},[e._v("X")]):e._e()],2)},C=[],x=r("1cbc"),D=r("be89"),w={name:"ProductList",components:{ModalProduct:x["a"],Item:D["a"]},data:function(){return{showModal:!1,products:[],productsCount:{}}},methods:{addProducts:function(){Object.keys(this.$store.state.groupIDselected).length>0?(this.getProducts(),this.showModal=!this.showModal,alert("Productos añadidos.")):alert("No tienes productos seleccionados.")},getProducts:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,o,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=[],o={},t.t0=regeneratorRuntime.keys(e.$store.state.groupIDselected);case 3:if((t.t1=t.t0()).done){t.next=12;break}return a=t.t1.value,t.next=7,e.$http.get("products/".concat(a));case 7:i=t.sent,r.push(i.data.datos[0]),o[a]=[e.$store.state.groupIDselected[a][0],i.data.datos[0].cantidad],t.next=3;break;case 12:e.products=r,e.productsCount=o;case 14:case"end":return t.stop()}}),t)})))()},deleteProduct:function(e){this.$store.commit("deleteID",e),this.getProducts()},updateProducts:function(){this.$store.commit("updateGroup",this.productsCount),this.showModal=!this.showModal},upCounts:function(e){this.$store.state.groupIDselected[e]=this.productsCount[e]}},mounted:function(){-1!=this.$store.state.idSelected[0]&&this.$store.commit("addID",this.$store.state.idSelected),this.getProducts()}},k=w,P=(r("8dc6"),Object(h["a"])(k,$,C,!1,null,"7e92553a",null)),y=P.exports,q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"image-container"},[r("p",[e._v("Foto de la promoción")]),r("div",{staticClass:"image-add"},[r("img",{staticClass:"img-prom",attrs:{src:e.imagen,alt:""},on:{click:function(t){return e.addFiles()}}})]),r("input",{ref:"files",staticClass:"images_input",attrs:{type:"file",id:"files",accept:"image/*"},on:{change:function(t){return e.getImage()}}}),e.$v.image.required?e._e():r("span",{staticClass:"formulario_check-error"},[e._v(" Coloque una fotografia ")])])},N=[],I=(r("b0c0"),{name:"ImageAdd",data:function(){return{image:""}},validations:{image:{required:c["required"]}},methods:{addFiles:function(){this.$refs.files.click()},getImage:function(){var e=this,t=this.$refs.files.files,r=t[0];if(void 0!=r)if(/\.(jpe?g|png)$/i.test(r.name)){if(r.size>1048576)return void alert(r.name+" es muy pesado (> 1MB)");var o=new FileReader;o.addEventListener("load",(function(t){var o=new Image;o.onload=function(){o.width<640||o.width>1366?alert("El ancho de "+r.name+" debe estar entre 640px y 1366px"):o.height<360||o.height>768?alert("El alto de "+r.name+" debe estar entre 360px y 768px"):(e.image=t.target.result,e.$emit("send-image",e.image))},o.src=t.target.result})),o.readAsDataURL(r)}else alert(r.name+" no es un archivo jpg o png")}},computed:{imagen:function(){return""==this.image?r("a861"):this.image}}}),M=I,L=(r("91d8"),Object(h["a"])(M,q,N,!1,null,null,null)),j=L.exports,O={name:"RegistroPromocion",components:{Form:b,ProductList:y,ImageAdd:j},data:function(){return{imagen:""}},methods:{passImage:function(e){this.imagen=e}},computed:{isMoreThanTwo:function(){return Object.keys(this.$store.state.groupIDselected).length<2}},destroyed:function(){this.$store.commit("updateGroup",{})}},E=O,F=(r("8096"),Object(h["a"])(E,o,a,!1,null,"597414d1",null));t["default"]=F.exports},8096:function(e,t,r){"use strict";var o=r("f871"),a=r.n(o);a.a},8103:function(e,t,r){"use strict";var o=r("b651"),a=r.n(o);a.a},"8dc6":function(e,t,r){"use strict";var o=r("a3a6"),a=r.n(o);a.a},"91d8":function(e,t,r){"use strict";var o=r("37cf"),a=r.n(o);a.a},a3a6:function(e,t,r){},a6a9:function(e,t,r){},a861:function(e,t,r){e.exports=r.p+"img/add-product.b045e570.png"},b651:function(e,t,r){},f871:function(e,t,r){},faab:function(e,t,r){"use strict";var o=r("a6a9"),a=r.n(o);a.a}}]);
//# sourceMappingURL=chunk-ae226d88.cef5e296.js.map